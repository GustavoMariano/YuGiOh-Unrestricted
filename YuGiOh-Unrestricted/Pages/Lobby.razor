@page "/lobby"
@inject NavigationManager Nav
@inject AppState App

<h3>Lobby</h3>

@if (App.UserId == Guid.Empty)
{
    <p>You need to login. <a href="/login">Login</a></p>
}
else
{
    <EditForm Model="this" OnValidSubmit="JoinBattle">
        <div class="join-container">
            <input @bind="battleCode" placeholder="Battle code" />
            <button type="submit">Join Battle</button>
        </div>
    </EditForm>

    <EditForm Model="this" OnValidSubmit="GoDecks">
        <div class="join-container">
            <button type="submit">Build Decks</button>
        </div>
    </EditForm>
}

@code {
    private string battleCode = "";

    public void JoinBattle()
    {
        Console.WriteLine($"[DEBUG] JoinBattle called with code={battleCode}");
        if (!string.IsNullOrWhiteSpace(battleCode))
            Nav.NavigateTo($"/battle/{battleCode}");
    }

    public void GoDecks()
    {
        Console.WriteLine("[DEBUG] GoDecks called");
        Nav.NavigateTo("/decks");
    }
}
